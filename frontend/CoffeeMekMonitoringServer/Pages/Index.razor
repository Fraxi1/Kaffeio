@page "/"
@using System.Security.Claims

<PageTitle>Dashboard - Kaffeio</PageTitle>

<div class="container-fluid py-4">
    <AuthorizeView>
        <Authorized>
            <!-- Header Dashboard -->
            <div class="row mb-4">
                <div class="col">
                    <div class="d-flex align-items-center justify-content-between">
                        <div>
                            <h1 class="mb-1">
                                <i class="fas fa-coffee text-primary me-3"></i>
                                Dashboard Kaffeio
                            </h1>
                            <p class="text-muted mb-0">
                                Sistema di Monitoraggio Macchine da Caffè
                            </p>
                        </div>
                        <div class="text-end">
                            <small class="text-muted">
                                <i class="fas fa-clock me-2"></i>
                                @DateTime.Now.ToString("dd MMMM yyyy, HH:mm", new System.Globalization.CultureInfo("it-IT"))
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Benvenuto -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-primary border-0 shadow-sm" role="alert">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-user-circle fa-2x me-3"></i>
                            <div>
                                <h5 class="alert-heading mb-1">
                                    Benvenuto, @context.User.Identity?.Name!
                                </h5>
                                <p class="mb-0">
                                    Accesso effettuato come <strong>@context.User.FindFirst(ClaimTypes.Email)?.Value</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cards Principali -->
            <div class="row mb-4">
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100 hover-shadow">
                        <div class="card-body text-center">
                            <div class="mb-3">
                                <i class="fas fa-users fa-3x text-primary"></i>
                            </div>
                            <h5 class="card-title">Gestione Utenti</h5>
                            <p class="card-text text-muted">
                                Visualizza la lista degli utenti registrati nel sistema Kaffeio
                            </p>
                            <a href="/users" class="btn btn-primary">
                                <i class="fas fa-arrow-right me-2"></i>
                                Vai agli Utenti
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100 hover-shadow">
                        <div class="card-body text-center">
                            <div class="mb-3">
                                <i class="fas fa-chart-line fa-3x text-success"></i>
                            </div>
                            <h5 class="card-title">Monitoraggio</h5>
                            <p class="card-text text-muted">
                                Visualizza statistiche e metriche delle macchine da caffè
                            </p>
                            <button class="btn btn-outline-success" disabled>
                                <i class="fas fa-cog me-2"></i>
                                In Sviluppo
                            </button>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card border-0 shadow-sm h-100 hover-shadow">
                        <div class="card-body text-center">
                            <div class="mb-3">
                                <i class="fas fa-cogs fa-3x text-info"></i>
                            </div>
                            <h5 class="card-title">Configurazione</h5>
                            <p class="card-text text-muted">
                                Configura le impostazioni del sistema e delle macchine
                            </p>
                            <button class="btn btn-outline-info" disabled>
                                <i class="fas fa-cog me-2"></i>
                                In Sviluppo
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Informazioni Sistema -->
            <div class="row">
                <div class="col-lg-8 mb-4">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-light border-0">
                            <h6 class="mb-0">
                                <i class="fas fa-info-circle me-2"></i>
                                Informazioni Sistema
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-muted mb-2">Dettagli Utente</h6>
                                    <ul class="list-unstyled">
                                        <li class="mb-1">
                                            <strong>Nome:</strong> @context.User.Identity?.Name
                                        </li>
                                        <li class="mb-1">
                                            <strong>Email:</strong> @context.User.FindFirst(ClaimTypes.Email)?.Value
                                        </li>
                                        <li class="mb-1">
                                            <strong>ID Utente:</strong> @context.User.FindFirst("UserId")?.Value
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-muted mb-2">Sistema</h6>
                                    <ul class="list-unstyled">
                                        <li class="mb-1">
                                            <strong>Versione:</strong> v1.0.0
                                        </li>
                                        <li class="mb-1">
                                            <strong>API:</strong> Kaffeio Backend
                                        </li>
                                        <li class="mb-1">
                                            <strong>Ambiente:</strong> 
                                            @if (Configuration.GetValue<bool>("UseFakes"))
                                            {
                                                <span class="badge bg-warning">Demo</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-success">Produzione</span>
                                            }
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 mb-4">
                    <div class="card border-0 shadow-sm">
                        <div class="card-header bg-light border-0">
                            <h6 class="mb-0">
                                <i class="fas fa-link me-2"></i>
                                Collegamenti Rapidi
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="d-grid gap-2">
                                <a href="/users" class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-users me-2"></i>
                                    Lista Utenti
                                </a>
                                <a href="/counter" class="btn btn-outline-secondary btn-sm">
                                    <i class="fas fa-calculator me-2"></i>
                                    Counter Demo
                                </a>
                                <a href="/weather" class="btn btn-outline-info btn-sm">
                                    <i class="fas fa-cloud-sun me-2"></i>
                                    Weather Demo
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </Authorized>
        <NotAuthorized>
            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-6">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body text-center py-5">
                            <div class="mb-4">
                                <i class="fas fa-coffee fa-4x text-primary"></i>
                            </div>
                            <h2 class="mb-3">Benvenuto in Kaffeio</h2>
                            <p class="text-muted mb-4">
                                Sistema di Monitoraggio per Macchine da Caffè
                            </p>
                            <p class="text-muted mb-4">
                                Effettua l'accesso per visualizzare il dashboard e gestire il sistema.
                            </p>
                            <a href="/login" class="btn btn-primary btn-lg">
                                <i class="fas fa-sign-in-alt me-2"></i>
                                Accedi al Sistema
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </NotAuthorized>
    </AuthorizeView>
</div>

@code {
    [Inject] private IConfiguration Configuration { get; set; } = default!;
}
